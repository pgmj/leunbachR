# import code
files <- list.files(path = "R")
for (i in files) {
  source(paste0("R/",i))
}
set.seed(87365)

d3a <- data.frame(
  a_sum = c(1L,4L,
            4L,6L,8L,6L,3L,3L,6L,7L,8L,5L,5L,
            6L,6L,6L,8L,4L,8L,5L,4L,2L,0L,3L,
            2L,5L,7L,6L,5L,6L,5L,6L,4L,3L,9L,4L,
            5L,3L,5L,1L,4L,4L,6L,7L,4L,2L,8L,
            5L,7L,3L,4L,8L,4L,5L,4L,8L,3L,5L,
            5L,7L,8L,6L,2L,5L,3L,6L,5L,6L,5L,
            8L,5L,0L,6L,5L,7L,5L,3L,5L,7L,7L,8L,
            5L,3L,7L,4L,3L,8L,4L,5L,6L,6L,7L,
            5L,6L,5L,4L,8L,4L,8L,8L,4L,5L,3L,
            4L,3L,5L,7L,4L,2L,5L,6L,3L,3L,5L,
            6L,9L,5L,3L,3L,3L,9L,2L,7L,2L,6L,3L,
            7L,6L,2L,8L,7L,5L,9L,5L,5L,8L,3L,
            5L,4L,3L,5L,0L,5L,2L,5L,8L,3L,4L,
            6L,4L,5L,3L,2L,5L,6L,5L,6L,1L,5L,
            4L,7L,4L,5L,8L,3L,6L,7L,2L,6L,2L,4L,
            7L,2L,8L,1L,6L,6L,5L,2L,5L,3L,7L,
            4L,6L,4L,5L,10L,8L,6L,6L,8L,8L,6L,
            3L,3L,9L,7L,5L,1L,4L,5L,8L,4L,5L,
            3L,4L,4L,4L,4L,3L,6L,6L,9L,6L,4L,
            6L,4L,5L,2L,2L,1L,5L,6L,3L,5L,6L,6L,
            4L,8L,6L,7L,4L,3L,2L,3L,1L,7L,7L,
            4L,3L,6L,4L,6L,4L,4L,6L,5L,2L,3L,
            5L,6L,3L,3L,3L,4L,9L,8L,6L,4L,1L,
            0L,7L,6L,6L,7L,5L,4L,1L,5L,6L,5L,6L,
            4L,3L,7L,2L,6L,3L,8L,5L,8L,4L,6L,
            2L,7L,3L,4L,7L,4L,3L,5L,7L,6L,9L,
            7L,5L,9L,3L,5L,9L,2L,5L,5L,2L,6L,
            6L,3L,3L,2L,8L,5L,5L,3L,3L,4L,5L,1L,
            4L,7L,7L,3L,7L,5L,6L,6L,6L,7L,6L,
            7L,4L,4L,8L,4L,8L,8L,4L,4L,5L,3L,
            4L,9L,6L,5L,4L,5L,3L,4L,5L,6L,8L,
            6L,2L,3L,3L,3L,4L,7L,8L,3L,10L,6L,
            7L,3L,5L,6L,4L,4L,4L,4L,3L,9L,5L,1L,
            6L,5L,5L,5L,6L,3L,3L,5L,4L,3L,5L,
            6L,6L,7L,4L,6L,3L,2L,1L,6L,5L,9L,
            4L,4L,5L,5L,5L,2L,4L,3L,3L,4L,1L,
            6L,4L,4L,5L,5L,4L,8L,5L,4L,8L,5L,6L,
            2L,5L,7L,3L,4L,6L,6L,8L,6L,7L,3L,
            4L,3L,5L,5L,3L,8L,9L,9L,1L,5L,3L,
            4L,6L,6L,1L,3L,9L,6L,6L,9L,8L,7L,
            7L,3L,3L,5L,6L,2L,5L,9L,6L,4L,5L,2L,
            6L,4L,9L,4L,4L,10L,5L,2L,8L,6L,6L,
            7L,2L,6L,3L,5L,4L,6L,5L,6L,4L,8L,
            6L,5L,4L,7L,8L,9L,2L,2L,4L,6L,3L,
            3L,7L),
  c_sum = c(8L,4L,
            7L,3L,5L,6L,6L,4L,5L,2L,6L,6L,6L,
            4L,3L,9L,8L,3L,4L,2L,4L,6L,7L,2L,
            4L,4L,5L,8L,1L,7L,5L,4L,5L,5L,8L,5L,
            7L,8L,2L,6L,8L,2L,4L,9L,8L,3L,4L,
            6L,7L,6L,7L,4L,7L,9L,4L,7L,2L,6L,
            5L,4L,4L,7L,5L,2L,4L,3L,7L,4L,8L,
            9L,4L,4L,6L,5L,3L,9L,8L,1L,6L,4L,4L,
            3L,5L,8L,3L,8L,2L,6L,5L,6L,6L,9L,
            5L,2L,6L,6L,4L,7L,1L,1L,2L,7L,5L,
            7L,3L,6L,8L,4L,5L,7L,3L,7L,3L,4L,
            4L,4L,5L,4L,7L,3L,3L,3L,3L,6L,8L,6L,
            8L,4L,4L,5L,7L,5L,3L,3L,1L,5L,5L,
            5L,8L,3L,7L,8L,4L,4L,3L,4L,4L,7L,
            7L,5L,5L,7L,7L,4L,5L,5L,4L,8L,7L,
            4L,5L,3L,2L,9L,2L,6L,7L,5L,7L,9L,5L,
            3L,4L,6L,6L,2L,3L,8L,8L,3L,4L,5L,
            5L,4L,5L,7L,5L,3L,7L,1L,4L,5L,8L,
            3L,4L,7L,6L,4L,4L,2L,9L,6L,6L,4L,
            8L,6L,7L,8L,1L,4L,6L,7L,5L,5L,5L,8L,
            6L,7L,3L,5L,8L,5L,7L,5L,3L,4L,2L,
            5L,7L,2L,7L,7L,5L,3L,5L,3L,4L,5L,
            8L,5L,4L,4L,7L,3L,3L,9L,8L,6L,6L,
            6L,4L,5L,5L,5L,8L,2L,9L,6L,4L,7L,6L,
            5L,3L,6L,9L,6L,7L,3L,4L,6L,7L,7L,
            6L,6L,3L,4L,6L,7L,4L,4L,2L,6L,4L,
            1L,4L,3L,3L,8L,5L,6L,6L,5L,6L,2L,
            7L,5L,8L,6L,6L,7L,2L,4L,2L,6L,3L,5L,
            4L,7L,6L,4L,1L,7L,4L,6L,8L,7L,9L,
            2L,6L,5L,7L,7L,3L,3L,2L,6L,5L,6L,
            6L,5L,6L,2L,4L,7L,3L,1L,1L,7L,9L,
            4L,7L,5L,7L,7L,8L,6L,7L,3L,3L,4L,7L,
            3L,8L,6L,7L,5L,5L,5L,2L,8L,3L,4L,
            9L,7L,5L,2L,6L,4L,5L,8L,7L,3L,9L,
            3L,8L,4L,3L,4L,4L,5L,4L,5L,8L,6L,
            7L,6L,5L,3L,7L,4L,6L,2L,6L,4L,2L,8L,
            4L,8L,2L,8L,6L,3L,7L,5L,4L,6L,2L,
            9L,5L,6L,6L,5L,6L,6L,4L,4L,4L,3L,
            3L,6L,5L,7L,8L,3L,4L,7L,6L,7L,3L,
            5L,6L,4L,4L,5L,4L,2L,3L,5L,5L,6L,8L,
            5L,5L,6L,6L,6L,6L,1L,4L,3L,5L,5L,
            9L,4L,6L,4L,7L,4L,7L,6L,6L,7L,6L,
            7L,8L,7L,8L,9L,6L,3L,4L,4L,5L,5L,
            6L,7L,6L,5L,5L,6L,6L,4L,6L,9L,6L,5L,
            7L,7L,4L,6L,6L,5L,5L,2L,5L,7L,6L,
            3L)
)

fit <- leunbach_ipf(d3a, verbose = TRUE)
print(fit)
leunbach_equate(fit)
boot <- leunbach_bootstrap(fit, verbose = T, n_cores = 12, nsim = 100)
print(boot)


get_equating_table(boot)
