% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ipf.R
\name{leunbach_ipf}
\alias{leunbach_ipf}
\title{Estimate Leunbach Score Parameters using Iterative Proportional Fitting}
\usage{
leunbach_ipf(
  data,
  max_score1 = NULL,
  max_score2 = NULL,
  max_iter = 1000,
  tol = 1e-10,
  verbose = FALSE
)
}
\arguments{
\item{data}{A data. frame or matrix with two columns:
Column 1: Sum scores from Test 1
Column 2: Sum scores from Test 2}

\item{max_score1}{Maximum possible score for Test 1 (default: max observed)}

\item{max_score2}{Maximum possible score for Test 2 (default: max observed)}

\item{max_iter}{Maximum number of iterations for IPF}

\item{tol}{Convergence tolerance}

\item{verbose}{Print iteration progress}
}
\value{
A list of class "leunbach_ipf" containing:
\itemize{
\item gamma: Score parameters for Test1 (generalized symmetric functions)
\item delta: Score parameters for Test2 (generalized symmetric functions)
\item sigma: Score parameters for total score (Test1 + Test2)
\item log_gamma: Log of gamma parameters
\item log_delta: Log of delta parameters
\item log_sigma: Log of sigma parameters
\item fitted: Fitted frequency table
\item observed:  Observed frequency table
\item iterations: Number of iterations to convergence
\item converged:  Logical indicating convergence
\item test1_scores: Score values for Test1
\item test2_scores: Score values for Test2
\item total_scores: Score values for total score
\item g_sq: Likelihood ratio test statistic
\item chi_sq: Pearson chi-square statistic
\item df:  Degrees of freedom
\item p_value: P-value for likelihood ratio test
}
}
\description{
Estimates score parameters for Leunbach test equating based on the power series
distribution framework.  The total score distribution in Rasch models follows a
power series distribution where score parameters are defined by generalized
symmetric functions of the item parameters.
}
\details{
The model is based on the power series distribution (PSD) for sum scores in
Rasch models.  For a test with k polytomous items, the probability of obtaining
sum score r is:

\deqn{P(R = r | \theta) = \frac{\gamma_r \theta^r}{\sum_s \gamma_s \theta^s}}

where \eqn{\gamma_r} is the generalized symmetric function of order r of the
item parameters, and \eqn{\theta = exp(\beta)} is the person parameter.

The model is over-parameterized, so we apply identification constraints:
\itemize{
\item \eqn{\gamma_{min}} = 1 (lowest observed score parameter fixed at 1)
\item \eqn{\delta_{min}} = 1 (lowest observed score parameter fixed at 1)
\item The highest score parameters are constrained so that their product
equals the product of all score parameters (Rasch-style constraint)
}

The sigma parameters for the total score (S = X + Y) are computed as:
\deqn{\sigma_s = \sum_{x+y=s} \gamma_x \delta_y}
}
\examples{
# Simulate test score data
set.seed(123)
n <- 500
theta <- rnorm(n)
test1 <- pmin(pmax(round(3 + 1.5 * theta + rnorm(n, sd = 0.8)), 0), 6)
test2 <- pmin(pmax(round(2.5 + 1.3 * theta + rnorm(n, sd = 0.7)), 0), 5)
score_data <- data.frame(test1 = test1, test2 = test2)

# Estimate parameters (specifying max possible scores)
fit <- leunbach_ipf(score_data, max_score1 = 6, max_score2 = 5, verbose = TRUE)
print(fit)
summary(fit)

}
\references{
Leunbach, G. (1976). A probabilistic measurement model for assessing whether
two tests measure the same personal factor. Copenhagen: Danish Institute for
Educational Research.

Kreiner, S. (2007). Validity and objectivity:  Reflections on the role and
nature of Rasch models. Nordic Psychology, 59(3), 268-298.
}
